<?php
/**
 * This serves as a terminator for object injection attacks.
 *
 * Just pass in the following serialized payload where a object injection vulnerability
 * is present:
 *
 * O:4:"Evil":0:{};
 */
class Evil {
	public function __wakeup() : void {
		/*
		 * We send the output both to the default error log, and
		 * the rendered page. In some cases where the response isn't
		 * renderes, such as in ajax calls, we still get the indicator
		 * in the webserver logs.
		 */
		error_log( "[*] Evil object unserialize! BOOM!" );
		die( "[*] Evil object unserialize! BOOM!");
	}
}
